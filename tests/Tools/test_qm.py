import pathlib
import argparse
from pathlib import Path
import pytest
from icecream import ic
from Tools.qm import *


def test_qm():

    x = {"out": "output.dat", "start": -
         0.5, "end": 10.5, "lw": 1, "mf": 500.0, "cutoff": 0.001, "debug": False}
    v = [964, 2775.76, 2768.20, 928]

    J = np.array([[0.0,   0.0,   0.0,   0.0],
                  [0.0,   0.0, 16.97,   0.0],
                  [0.0, 16.97,   0.0,   7.0],
                  [0.0,   0.0,   7.0,   0.0]])

    R_peak = qm_partial(v=v, J=J, nIntergals=1, idx0_nspins=1,
                        args=argparse.Namespace(**x))
    assert R_peak == [(2751.6221950398317, 0.004640626007360026), (2771.8744928000124, 0.17784222534173624), (2756.524704127526, 0.0012892566474453908), (2773.972045104938, 0.1517131554977363), (2751.6221950398317, 0.004640626007360041), (2771.874492800012, 0.1778422253417366), (2756.524704127526, 0.0012892566474452464), (2773.972045104938, 0.15171315549773512),
                      (2788.8444314073913, 0.015592147298183447), (2768.592133647211, 0.05231693537842409), (2790.9419837123173, 0.002137664026614798), (2773.4946427349055, 0.09446798980249939), (2788.8444314073913, 0.015592147298183607), (2768.592133647211, 0.05231693537842384), (2790.941983712317, 0.0021376640266144937), (2773.4946427349055, 0.09446798980250147)]
